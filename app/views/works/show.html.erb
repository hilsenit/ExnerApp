<%= javascript_include_tag "html.sortable", 'data-turbolinks-track' => true if logged_in?(:site_admin) %>
<%= javascript_include_tag "work_images", 'data-turbolinks-track' => true if logged_in?(:site_admin) %>

<div class="row work-row">
	<%= logged_in_work_helper if logged_in?(:site_admin) %>

	<div class="col-lg-12">
		<h2 class="work-headline text-center"><%= @work.name %></h2>
	</div>
	<div class="vertical-center">
		<%= image_tag @first_image.image, id: "largeImage", data: { pos: @first_image.position } %>	    

	</div>
	<div class="col-lg-12 hide-it info-field-work">
		<%= info_helper @work %>
		<div class="info-beskrivelse">
		<%= simple_format(@work.description) if @work.description %>
		</div>
	</div>

	<%= render partial: "img_cat_bar", locals: {image_categories: @image_categories } %>

	<%= render partial: "thumbnails", locals: {image_categories: @image_categories } %>



</div>

<script type="text/javascript">
// Thumbnail til stort billede
	
	$(document).keydown(function(e) {
	    switch(e.which) {
	        case 37: // venstre piletast
		        var image_id = $("#largeImage").data('pos');
		        var new_image_id = image_id - 1;
		        var large_url = $("#" + new_image_id).data("largeimage");
		        $("#largeImage").attr("src", large_url); 
		        $("#largeImage").data("pos", new_image_id);
	        break;

	        case 39: // h√∏jre piletast
		        var image_id = $("#largeImage").data('pos');
		        var new_image_id = image_id + 1;
		        var large_url = $("#" + new_image_id).data("largeimage");
		        $("#largeImage").attr("src", large_url); 
		        $("#largeImage").data("pos", new_image_id);
	        break;

	        default: return; // exit this handler for other keys
	    }
	    e.preventDefault(); // prevent the default action (scroll / move caret)
	});

	$(".thumbnaildiv").click(function() {
		var thumbsrc = $(this).data("largeimage");
		var thumbid = $(this).attr("id");
		$("#largeImage").attr("src", thumbsrc);
		$("#largeImage").data("pos", parseInt(thumbid));
	});
// Skift mellem thumbnailsoversigterne
	$(".img-cat-nav").on("click", function() {
		$(this).addClass('active').siblings().removeClass('active');
		var divId = $(this).attr("data-divid");
		$(".thumbnail-container").hide();
		$("." + divId).show();
		var first_child = $("." + divId).children().first()
		var catthumbsrc = first_child.data("largeimage");
		var new_img_id = first_child.data("pos");
		$("#largeImage").attr("src", catthumbsrc);
		$("#largeImage").data("pos", new_img_id);

	});
	
// info visning
	$(".info-button").on("click", function() {
		$(this).toggleClass("info-button-active");
		$(".info-field-work").slideToggle("fast");
	});


</script>

